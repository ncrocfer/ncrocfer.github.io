<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ncrocfer, Python & Web security">

    
    <title>Installer un module à la création d'un virtualenv // ncrocfer // Python & Web security</title>
    

    

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.3.0/pure-min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://ncrocfer.github.io/css/pure.css">
    <link rel="stylesheet" href="https://ncrocfer.github.io/css/pygments.css">
    

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    
<script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js"></script>
<script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script>

</head>

<body>

<div class="pure-g-r" id="layout">
    <div class="sidebar pure-u">
    <div class="cover-img" style="background-color: #0D302E;">
        <div class="cover-body">
            <header class="header">
                <hgroup>
                    <h1 class="brand-main"><a href="/">ncrocfer</a></h1>
                    <p class="tagline">Python & Web security</p>
                    
                    
                    <p class="links"><a href="https://ncrocfer.github.io/a-propos">A propos</a></p>
                    
                    
                    
                    <p class="links"><a href="https://ncrocfer.github.io/snippets">Snippets</a></p>
                    
                    
                    <p class="social">
                        
                        <a href="https://twitter.com/ncrocfer">
                            <i class="fa fa-twitter-square fa-3x"></i>
                        </a>
                        
                        <a href="https://github.com/ncrocfer">
                            <i class="fa fa-github fa-3x"></i>
                        </a>
                        
                    <p>
                </hgroup>
            </header>
        </div>
    </div>
</div>
    <div class="pure-u">
        <div class="content">
            <section class="post">
                <header class="post-header">
                    <h1>Installer un module à la création d'un virtualenv</h1>
                    
                        <p class="post-meta">
                            
                                category:
                            
                            
                                <a href="https://ncrocfer.github.io/categories/howtos">Howtos</a> 
                            , date: Wed 23 December 2015
                        </p>
                    
                    
                        <p class="post-meta">
                            
                                tag =
                            
                            
                                <a class="post-category" href="https://ncrocfer.github.io/tags/python">python</a>
                            
                        </p>
                    
                </header>
            </section>
            <div class="document">
<p>L'utilisation des environnements virtuels (avec <strong>Virtualenv</strong> et <strong>Virtualenvwrapper</strong>) est inévitable si vous développez régulièrement en Python. D'une part leur utilisation permet de laisser votre hôte propre, et d'autre part différentes versions d'un même module peuvent être testées de manière très simple.</p>

<p>En revanche aucun module n'est disponible par défaut dans un nouvel environnement récemment créé.</p>
<p>Pour cela 2 solutions existent : la première est d'importer les modules disponibles dans l'environnement global (votre host). En gros un <strong>pip freeze</strong> dans votre host et dans votre virtualenv renverra le même résultat :</p>
<div class="highlight"><pre><span class="nv">$ </span>mkvirtualenv foo --system-site-packages
</pre></div>
<p>L'idée est d'installer et de mettre à jour sur votre host les modules que vous utilisez le plus souvent, et d'installer dans le virtualenv ceux qui sont plus spécifiques à chaque projet.</p>
<p>La seconde solution, si vous ne souhaitez vraiment rien installer sur le host, et d'installer automatiquement les modules à la création du virtualenv. C'est dans le fichier <strong>~/.virtualenvs/postmkvirtualenv</strong> que les commandes se font :</p>
<div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="c"># This hook is sourced after a new virtualenv is activated.</span>

pip install requests
pip install httpie
</pre></div>
<p>La création de l'environnement est un peu plus longue mais les modules sont directement disponibles dans leur dernière version :</p>
<div class="highlight"><pre><span class="nv">$ </span>mkvirtualenv foo
New python executable in foo/bin/python
Installing setuptools, pip...done.
Downloading/unpacking requests
  Downloading requests-2.9.1-py2.py3-none-any.whl <span class="o">(</span>501kB<span class="o">)</span>: 501kB downloaded
Installing collected packages: requests
Successfully installed requests
Cleaning up...
Downloading/unpacking httpie
  Downloading httpie-0.9.2-py2.py3-none-any.whl <span class="o">(</span>66kB<span class="o">)</span>: 66kB downloaded
Requirement already satisfied <span class="o">(</span>use --upgrade to upgrade<span class="o">)</span>: requests&gt;<span class="o">=</span>2.3.0 in /home/ncrocfer/.virtualenvs/foo/lib/python2.7/site-packages <span class="o">(</span>from httpie<span class="o">)</span>
Downloading/unpacking Pygments&gt;<span class="o">=</span>1.5 <span class="o">(</span>from httpie<span class="o">)</span>
  Downloading Pygments-2.0.2-py2-none-any.whl <span class="o">(</span>672kB<span class="o">)</span>: 672kB downloaded
Installing collected packages: httpie, Pygments
Successfully installed httpie Pygments
Cleaning up...
<span class="o">(</span>foo<span class="o">)</span> <span class="nv">$ </span>pip freeze
<span class="nv">Pygments</span><span class="o">==</span>2.0.2
<span class="nv">argparse</span><span class="o">==</span>1.2.1
<span class="nv">httpie</span><span class="o">==</span>0.9.2
<span class="nv">requests</span><span class="o">==</span>2.9.1
<span class="nv">wsgiref</span><span class="o">==</span>0.1.2
<span class="o">(</span>foo<span class="o">)</span> <span class="err">$</span>
</pre></div>
</div>


            <a href="https://twitter.com/share" class="twitter-share-button" data-url="https://ncrocfer.github.io/2015/12/23/installer-un-module-a-la-creation-dun-virtualenv" data-text="Installer un module à la création d'un virtualenv" data-via="ncrocfer">Tweet</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

            <div class="hr"></div>
            <a href="#" class="go-top">Go Top</a>
            <footer class="footer">
    <p>&copy; ncrocfer &ndash;
        Built with <a href="https://github.com/ncrocfer/radric">Radric</a>
        and a modified version of <a href="https://github.com/PurePelicanTheme/pure">Pure Theme</a>
    </p>
</footer>
        </div>
    </div>
</div>

<script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-65778407-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>